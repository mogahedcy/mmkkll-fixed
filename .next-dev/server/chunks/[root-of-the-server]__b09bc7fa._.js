module.exports = [
"[project]/.next-internal/server/app/api/search/route/actions.js [app-rsc] (server actions loader, ecmascript)", ((__turbopack_context__, module, exports) => {

}),
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/@opentelemetry/api [external] (next/dist/compiled/@opentelemetry/api, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/@opentelemetry/api", () => require("next/dist/compiled/@opentelemetry/api"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/shared/lib/no-fallback-error.external.js [external] (next/dist/shared/lib/no-fallback-error.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/shared/lib/no-fallback-error.external.js", () => require("next/dist/shared/lib/no-fallback-error.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/action-async-storage.external.js [external] (next/dist/server/app-render/action-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/action-async-storage.external.js", () => require("next/dist/server/app-render/action-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/@prisma/client [external] (@prisma/client, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("@prisma/client", () => require("@prisma/client"));

module.exports = mod;
}),
"[project]/src/lib/prisma.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "prisma",
    ()=>prisma
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f40$prisma$2f$client__$5b$external$5d$__$2840$prisma$2f$client$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/@prisma/client [external] (@prisma/client, cjs)");
;
const globalForPrisma = globalThis;
const prisma = globalForPrisma.prisma ?? new __TURBOPACK__imported__module__$5b$externals$5d2f40$prisma$2f$client__$5b$external$5d$__$2840$prisma$2f$client$2c$__cjs$29$__["PrismaClient"]({
    log: ("TURBOPACK compile-time truthy", 1) ? [
        'query',
        'error',
        'warn'
    ] : "TURBOPACK unreachable"
});
if ("TURBOPACK compile-time truthy", 1) globalForPrisma.prisma = prisma;
}),
"[project]/src/data/articles-index.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "articlesIndex",
    ()=>articlesIndex
]);
const articlesIndex = [
    {
        id: 1,
        slug: 'best-car-shades-jeddah-2024',
        title: 'أفضل أنواع مظلات السيارات في جدة 2024 - دليل شامل للاختيار والتركيب',
        excerpt: 'دليل شامل لاختيار أفضل مظلة لسيارتك في مناخ جدة الساحلي. تعرف على المواد والتصاميم المختلفة ونصائح الاختيار.',
        category: 'مظلات سيارات',
        image: '/uploads/mazallat-1.webp',
        keywords: 'مظلات سيارات جدة، أفضل مظلات السيارات، تركيب مظلات جدة، مظلات حديد، مظلات قماش، حماية السيارات، المناخ الساحلي',
        tags: [
            'مظلات',
            'سيارات',
            'جدة',
            'دليل'
        ]
    },
    {
        id: 2,
        slug: 'wooden-pergola-maintenance-coastal-climate',
        title: 'كيفية صيانة البرجولة الخشبية في المناخ الساحلي - نصائح من خبراء جدة',
        excerpt: 'نصائح مهمة للحفاظ على برجولتك الخشبية من آثار الرطوبة والملوحة في جدة. جدول صيانة شهري وسنوي.',
        category: 'برجولات',
        image: '/uploads/pergola-1.jpg',
        keywords: 'برجولة خشبية جدة، صيانة برجولات، برجولات حدائق، تصميم برجولات جدة، صيانة الحدائق، المناخ الرطب، العناية بالخشب',
        tags: [
            'برجولات',
            'صيانة',
            'خشب',
            'نصائح'
        ]
    },
    {
        id: 3,
        slug: 'sandwich-panel-thermal-insulation-saudi',
        title: 'ساندوتش بانل: الحل الأمثل للعزل الحراري في السعودية',
        excerpt: 'لماذا يعتبر الساندوتش بانل الخيار الأول للمباني التجارية والصناعية؟ فوائد العزل الحراري وتوفير الطاقة.',
        category: 'ساندوتش بانل',
        image: '/uploads/sandwich-panel-1.jpg',
        keywords: 'ساندوتش بانل جدة، عزل حراري، ألواح ساندوتش بانل، تركيب ساندوتش بانل السعودية، عزل حراري، مباني تجارية، توفير الطاقة',
        tags: [
            'ساندوتش بانل',
            'عزل حراري',
            'توفير طاقة'
        ]
    },
    {
        id: 4,
        slug: 'smart-fences-privacy-elegance',
        title: 'السواتر الذكية في جدة: خصوصية وأناقة وتقنية حديثة',
        excerpt: 'تعرف على أحدث أنواع السواتر التي تجمع بين الجمال والوظيفة. سواتر متحركة وأتوماتيكية وصديقة للبيئة.',
        category: 'سواتر',
        image: '/uploads/sawater-1.webp',
        keywords: 'سواتر جدة، سواتر خصوصية، سواتر حديد، تركيب سواتر، سواتر قماش جدة، سواتر ذكية، خصوصية المنزل، التحكم الآلي',
        tags: [
            'سواتر',
            'خصوصية',
            'تقنية ذكية'
        ]
    },
    {
        id: 5,
        slug: 'royal-tents-luxury-occasions-guide',
        title: 'خيام ملكية فاخرة في جدة: دليل التصميم والتنفيذ للمناسبات الخاصة',
        excerpt: 'كيف تختار الخيمة الملكية المثالية لمناسباتك؟ أنواع الأقمشة والتصاميم والإكسسوارات لكل مناسبة.',
        category: 'خيام ملكية',
        image: '/uploads/khayyam-1.webp',
        keywords: 'خيام ملكية جدة، خيام فاخرة، تأجير خيام، خيام مناسبات جدة، خيام فاخرة، مناسبات اجتماعية، التراث السعودي، ضيافة',
        tags: [
            'خيام ملكية',
            'مناسبات',
            'فخامة'
        ]
    },
    {
        id: 6,
        slug: 'traditional-hair-houses-heritage-modern',
        title: 'بيوت الشعر التراثية في جدة: تجسيد الأصالة مع لمسة عصرية',
        excerpt: 'كيف تحافظ على الطابع التراثي لبيت الشعر مع إضافة لمسات عصرية؟ مواد تقليدية بتقنيات حديثة.',
        category: 'بيوت شعر',
        image: '/uploads/byoot-shaar-1.webp',
        keywords: 'بيوت شعر جدة، خيام تراثية، بيوت شعر تراثية، خيام بدوية جدة، التراث السعودي، ثقافة بدوية، تصميم تراثي',
        tags: [
            'بيوت شعر',
            'تراث',
            'أصالة'
        ]
    },
    {
        id: 7,
        slug: 'garden-design-trends-saudi-2024',
        title: 'أحدث اتجاهات تصميم وتنسيق الحدائق في جدة والمملكة 2024',
        excerpt: 'أحدث صيحات تنسيق الحدائق المناسبة للمناخ السعودي. نباتات محلية وأنظمة ري ذكية وتصاميم مستدامة.',
        category: 'تنسيق حدائق',
        image: '/uploads/landscaping-1.jpg',
        keywords: 'تنسيق حدائق جدة، تصميم حدائق، شركة تنسيق حدائق، حدائق منزلية جدة، تنسيق حدائق، نباتات صحراوية، ري ذكي، استدامة',
        tags: [
            'تنسيق حدائق',
            'نباتات محلية',
            'تصميم'
        ]
    },
    {
        id: 8,
        slug: 'renovation-secrets-modern-techniques',
        title: 'أسرار ترميم الملحقات بأحدث التقنيات - دليل شامل من خبراء جدة',
        excerpt: 'كيف تعيد الحياة لملحقاتك القديمة؟ تقنيات حديثة في الترميم والعزل وإضافة اللمسات العصرية.',
        category: 'ترميم',
        image: '/uploads/renovation-1.jpg',
        keywords: 'ترميم ملحقات جدة، تجديد ملحقات، شركة ترميم، ترميم منازل جدة، تطوير ملحقات، تقنيات حديثة، عزل متطور',
        tags: [
            'ترميم',
            'ملحقات',
            'تجديد'
        ]
    },
    {
        id: 9,
        slug: 'pergola-materials-comparison-jeddah',
        title: 'مقارنة شاملة لمواد البرجولات في جدة: الخشب مقابل الحديد مقابل الألومنيوم',
        excerpt: 'دليل مفصل لمقارنة مواد البرجولات المختلفة. مزايا وعيوب كل مادة في المناخ الساحلي لجدة.',
        category: 'برجولات',
        image: '/uploads/pergola-1.jpg',
        keywords: 'برجولات خشبية جدة، برجولات حديد، برجولات ألومنيوم، مقارنة مواد البرجولات، برجولات جدة، أفضل مواد البرجولات',
        tags: [
            'برجولات',
            'مواد',
            'مقارنة'
        ]
    },
    {
        id: 'mazallat-guide',
        slug: 'complete-car-shades-guide-jeddah-2024',
        title: 'دليل مظلات السيارات الشامل في جدة 2024 - أنواع وأسعار وتركيب',
        excerpt: 'دليل شامل ومفصل لكل ما يخص مظلات السيارات في جدة. أنواع المظلات، الأسعار، طرق التركيب، والصيانة.',
        category: 'مظلات سيارات',
        image: '/uploads/mazallat-1.webp',
        keywords: 'مظلات سيارات جدة، أسعار مظلات السيارات، تركيب مظلات جدة، مظلات PVC، مظلات حديد، شركة مظلات، دليل شامل مظلات',
        tags: [
            'مظلات',
            'سيارات',
            'دليل شامل',
            'جدة'
        ]
    }
];
}),
"[project]/src/app/api/search/route.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "GET",
    ()=>GET
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/prisma.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$data$2f$articles$2d$index$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/data/articles-index.ts [app-route] (ecmascript)");
;
;
;
async function GET(request) {
    try {
        const { searchParams } = new URL(request.url);
        const q = (searchParams.get('q') || '').trim();
        const category = (searchParams.get('category') || '').trim();
        const location = (searchParams.get('location') || '').trim();
        const type = (searchParams.get('type') || 'all').toLowerCase();
        const sortBy = (searchParams.get('sortBy') || 'relevance').toLowerCase();
        const page = Math.max(1, Number.parseInt(searchParams.get('page') || '1'));
        const limit = Math.min(50, Math.max(1, Number.parseInt(searchParams.get('limit') || '12')));
        const skip = (page - 1) * limit;
        let projects = [];
        let projectsTotal = 0;
        try {
            if (type === 'all' || type === 'projects') {
                projectsTotal = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].projects.count({
                    where: {
                        status: 'PUBLISHED',
                        AND: [
                            q ? {
                                OR: [
                                    {
                                        title: {
                                            contains: q
                                        }
                                    },
                                    {
                                        description: {
                                            contains: q
                                        }
                                    },
                                    {
                                        category: {
                                            contains: q
                                        }
                                    },
                                    {
                                        location: {
                                            contains: q
                                        }
                                    }
                                ]
                            } : {},
                            category ? {
                                category: {
                                    contains: category
                                }
                            } : {},
                            location ? {
                                location: {
                                    contains: location
                                }
                            } : {}
                        ]
                    }
                });
                projects = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].projects.findMany({
                    where: {
                        status: 'PUBLISHED',
                        AND: [
                            q ? {
                                OR: [
                                    {
                                        title: {
                                            contains: q
                                        }
                                    },
                                    {
                                        description: {
                                            contains: q
                                        }
                                    },
                                    {
                                        category: {
                                            contains: q
                                        }
                                    },
                                    {
                                        location: {
                                            contains: q
                                        }
                                    }
                                ]
                            } : {},
                            category ? {
                                category: {
                                    contains: category
                                }
                            } : {},
                            location ? {
                                location: {
                                    contains: location
                                }
                            } : {}
                        ]
                    },
                    select: {
                        id: true,
                        slug: true,
                        title: true,
                        description: true,
                        category: true,
                        location: true,
                        createdAt: true,
                        featured: true,
                        media_items: {
                            where: {
                                type: 'IMAGE'
                            },
                            orderBy: {
                                order: 'asc'
                            },
                            take: 1,
                            select: {
                                src: true,
                                thumbnail: true,
                                alt: true
                            }
                        }
                    },
                    orderBy: sortBy === 'name' ? [
                        {
                            title: 'asc'
                        }
                    ] : sortBy === 'date' ? [
                        {
                            createdAt: 'desc'
                        }
                    ] : [
                        {
                            featured: 'desc'
                        },
                        {
                            createdAt: 'desc'
                        }
                    ],
                    skip,
                    take: limit
                });
            }
        } catch (e) {
            console.warn('DB unavailable, skipping project search');
            projects = [];
            projectsTotal = 0;
        }
        const projectResults = projects.map((p)=>({
                id: String(p.id),
                type: 'project',
                title: p.title,
                description: p.description,
                category: p.category,
                location: p.location,
                image: p.media_items?.[0]?.thumbnail || p.media_items?.[0]?.src || '/favicon.svg',
                slug: p.slug || String(p.id),
                url: `/portfolio/${p.slug || p.id}`,
                createdAt: p.createdAt ? new Date(p.createdAt).getTime() : 0,
                featured: Boolean(p.featured)
            }));
        const filteredArticles = type === 'all' || type === 'articles' ? __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$data$2f$articles$2d$index$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["articlesIndex"].filter((a)=>{
            const haystack = [
                a.title,
                a.excerpt,
                a.category,
                a.keywords || '',
                ...a.tags || []
            ].join(' ').toLowerCase();
            const matchesQ = q ? haystack.includes(q.toLowerCase()) : true;
            const matchesCategory = category ? a.category.toLowerCase().includes(category.toLowerCase()) : true;
            return matchesQ && matchesCategory;
        }) : [];
        const scoredArticles = filteredArticles.map((a)=>{
            const title = a.title.toLowerCase();
            const ql = q.toLowerCase();
            const score = q ? title.startsWith(ql) ? 3 : title.includes(ql) ? 2 : 1 : 1;
            return {
                ...a,
                _score: score
            };
        });
        const sortedArticles = scoredArticles.sort((a, b)=>b._score - a._score);
        const start = skip;
        const end = skip + limit;
        const pagedArticles = sortedArticles.slice(start, end);
        const articlesTotal = sortedArticles.length;
        const articleResults = pagedArticles.map((a)=>({
                id: String(a.id),
                type: 'article',
                title: a.title,
                description: a.excerpt,
                category: a.category,
                location: 'جدة',
                image: a.image,
                slug: a.slug,
                url: `/articles/${a.slug}`,
                createdAt: 0,
                featured: false
            }));
        // Merge and sort by relevance/date depending on sortBy
        let combined = [
            ...projectResults,
            ...articleResults
        ];
        if (sortBy === 'date') combined = combined.sort((a, b)=>(b.createdAt || 0) - (a.createdAt || 0));
        if (sortBy === 'name') combined = combined.sort((a, b)=>a.title.localeCompare(b.title));
        const total = type === 'projects' ? projectsTotal : type === 'articles' ? articlesTotal : projectsTotal + articlesTotal;
        const hasMore = page * limit < total;
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            success: true,
            results: combined,
            total,
            query: q,
            page,
            limit,
            hasMore
        });
    } catch (error) {
        console.error('خطأ في البحث:', error);
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            success: false,
            error: 'حدث خطأ في البحث',
            results: [],
            total: 0,
            page: 1,
            limit: 12,
            hasMore: false
        }, {
            status: 500
        });
    }
}
}),
];

//# sourceMappingURL=%5Broot-of-the-server%5D__b09bc7fa._.js.map