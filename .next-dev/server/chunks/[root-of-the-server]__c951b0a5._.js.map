{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 68, "column": 0}, "map": {"version":3,"sources":["file:///app/code/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nimport { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined\n}\n\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient({\n  log: process.env.NODE_ENV === 'development' ? ['query', 'error', 'warn'] : ['error'],\n})\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\n"],"names":[],"mappings":";;;AAAA;;;AAIA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6HAAA,CAAA,eAAY,CAAC;IAC/D,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO;AAC1E;AAEA,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 89, "column": 0}, "map": {"version":3,"sources":["file:///app/code/src/app/api/dashboard/stats/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { prisma } from '@/lib/prisma';\n\nexport async function GET() {\n  try {\n    // جلب الإحصائيات الأساسية\n    const [\n      totalProjects,\n      publishedProjects,\n      featuredProjects,\n      totalViews,\n      totalLikes,\n      totalComments,\n      recentViews\n    ] = await Promise.all([\n      prisma.projects.count(),\n      prisma.projects.count({ where: { status: 'PUBLISHED' } }),\n      prisma.projects.count({ where: { featured: true } }),\n      prisma.projects.aggregate({ _sum: { views: true } }),\n      prisma.projects.aggregate({ _sum: { likes: true } }),\n      prisma.comments.count({ where: { status: 'APPROVED' } }),\n      prisma.project_views.count({\n        where: {\n          createdAt: {\n            gte: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000) // آخر 7 أيام\n          }\n        }\n      })\n    ]);\n\n    // حساب معدل التفاعل\n    const totalInteractions = (totalLikes._sum.likes || 0) + (totalComments || 0);\n    const engagement = totalProjects > 0 \n      ? Math.round((totalInteractions / totalProjects) * 100) / 100\n      : 0;\n\n    const stats = {\n      totalProjects,\n      publishedProjects,\n      totalViews: totalViews._sum.views || 0,\n      totalLikes: totalLikes._sum.likes || 0,\n      totalComments,\n      featuredProjects,\n      recentViews,\n      engagement\n    };\n\n    return NextResponse.json({\n      success: true,\n      stats\n    });\n\n  } catch (error) {\n    console.error('❌ خطأ في جلب الإحصائيات:', error);\n    return NextResponse.json(\n      { \n        error: 'حدث خطأ في جلب الإحصائيات',\n        stats: {\n          totalProjects: 0,\n          publishedProjects: 0,\n          totalViews: 0,\n          totalLikes: 0,\n          totalComments: 0,\n          featuredProjects: 0,\n          recentViews: 0,\n          engagement: 0\n        }\n      },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,eAAe;IACpB,IAAI;QACF,0BAA0B;QAC1B,MAAM,CACJ,eACA,mBACA,kBACA,YACA,YACA,eACA,YACD,GAAG,MAAM,QAAQ,GAAG,CAAC;YACpB,sHAAA,CAAA,SAAM,CAAC,QAAQ,CAAC,KAAK;YACrB,sHAAA,CAAA,SAAM,CAAC,QAAQ,CAAC,KAAK,CAAC;gBAAE,OAAO;oBAAE,QAAQ;gBAAY;YAAE;YACvD,sHAAA,CAAA,SAAM,CAAC,QAAQ,CAAC,KAAK,CAAC;gBAAE,OAAO;oBAAE,UAAU;gBAAK;YAAE;YAClD,sHAAA,CAAA,SAAM,CAAC,QAAQ,CAAC,SAAS,CAAC;gBAAE,MAAM;oBAAE,OAAO;gBAAK;YAAE;YAClD,sHAAA,CAAA,SAAM,CAAC,QAAQ,CAAC,SAAS,CAAC;gBAAE,MAAM;oBAAE,OAAO;gBAAK;YAAE;YAClD,sHAAA,CAAA,SAAM,CAAC,QAAQ,CAAC,KAAK,CAAC;gBAAE,OAAO;oBAAE,QAAQ;gBAAW;YAAE;YACtD,sHAAA,CAAA,SAAM,CAAC,aAAa,CAAC,KAAK,CAAC;gBACzB,OAAO;oBACL,WAAW;wBACT,KAAK,IAAI,KAAK,KAAK,GAAG,KAAK,IAAI,KAAK,KAAK,KAAK,MAAM,aAAa;oBACnE;gBACF;YACF;SACD;QAED,oBAAoB;QACpB,MAAM,oBAAoB,CAAC,WAAW,IAAI,CAAC,KAAK,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC;QAC5E,MAAM,aAAa,gBAAgB,IAC/B,KAAK,KAAK,CAAC,AAAC,oBAAoB,gBAAiB,OAAO,MACxD;QAEJ,MAAM,QAAQ;YACZ;YACA;YACA,YAAY,WAAW,IAAI,CAAC,KAAK,IAAI;YACrC,YAAY,WAAW,IAAI,CAAC,KAAK,IAAI;YACrC;YACA;YACA;YACA;QACF;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT;QACF;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,OAAO;gBACL,eAAe;gBACf,mBAAmB;gBACnB,YAAY;gBACZ,YAAY;gBACZ,eAAe;gBACf,kBAAkB;gBAClB,aAAa;gBACb,YAAY;YACd;QACF,GACA;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}