{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":["file:///app/code/src/app/api/sitemap/refresh/route.ts"],"sourcesContent":["\nimport { NextRequest, NextResponse } from 'next/server';\n\nconst SEARCH_ENGINES = [\n  {\n    name: 'Google',\n    url: 'https://www.google.com/ping?sitemap=',\n  },\n  {\n    name: 'Bing',\n    url: 'https://www.bing.com/ping?sitemap=',\n  },\n  {\n    name: 'Yandex',\n    url: 'https://webmaster.yandex.com/ping?sitemap=',\n  }\n];\n\nasync function notifySearchEngine(engineUrl: string, sitemapUrl: string, engineName: string) {\n  try {\n    const response = await fetch(`${engineUrl}${encodeURIComponent(sitemapUrl)}`, {\n      method: 'GET',\n      headers: {\n        'User-Agent': 'AlDeyar-SEO-Bot/1.0 (+https://aldeyarksa.tech)',\n      },\n      signal: AbortSignal.timeout(10000), // 10 second timeout\n    });\n    \n    return {\n      engine: engineName,\n      success: response.ok,\n      status: response.status,\n      message: response.ok ? 'تم الإشعار بنجاح' : `خطأ: ${response.status}`\n    };\n  } catch (error) {\n    return {\n      engine: engineName,\n      success: false,\n      status: 0,\n      message: `خطأ في الاتصال: ${error instanceof Error ? error.message : 'خطأ غير معروف'}`\n    };\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  const sitemapUrl = 'https://aldeyarksa.tech/sitemap.xml';\n  \n  try {\n    const results = await Promise.allSettled(\n      SEARCH_ENGINES.map(engine => \n        notifySearchEngine(engine.url, sitemapUrl, engine.name)\n      )\n    );\n\n    const notifications = results.map(result => \n      result.status === 'fulfilled' ? result.value : { \n        engine: 'Unknown', \n        success: false, \n        message: 'فشل في معالجة الطلب' \n      }\n    );\n\n    const successCount = notifications.filter(n => n.success).length;\n    const totalCount = notifications.length;\n\n    return NextResponse.json({\n      success: true,\n      message: `تم إشعار ${successCount} من أصل ${totalCount} محرك بحث`,\n      timestamp: new Date().toISOString(),\n      sitemap_url: sitemapUrl,\n      notifications,\n      summary: {\n        total: totalCount,\n        successful: successCount,\n        failed: totalCount - successCount\n      }\n    });\n\n  } catch (error) {\n    console.error('خطأ في إشعار محركات البحث:', error);\n    \n    return NextResponse.json({\n      success: false,\n      message: 'فشل في إشعار محركات البحث',\n      error: error instanceof Error ? error.message : 'خطأ غير معروف',\n      timestamp: new Date().toISOString()\n    }, { status: 500 });\n  }\n}\n\nexport async function GET() {\n  return NextResponse.json({\n    message: 'API إشعار محركات البحث - استخدم POST لإرسال الإشعارات',\n    endpoints: {\n      refresh: 'POST /api/sitemap/refresh',\n      sitemap: 'GET /sitemap.xml'\n    },\n    supported_engines: SEARCH_ENGINES.map(engine => engine.name)\n  });\n}\n"],"names":[],"mappings":";;;;AACA;;AAEA,MAAM,iBAAiB;IACrB;QACE,MAAM;QACN,KAAK;IACP;IACA;QACE,MAAM;QACN,KAAK;IACP;IACA;QACE,MAAM;QACN,KAAK;IACP;CACD;AAED,eAAe,mBAAmB,SAAiB,EAAE,UAAkB,EAAE,UAAkB;IACzF,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,GAAG,YAAY,mBAAmB,aAAa,EAAE;YAC5E,QAAQ;YACR,SAAS;gBACP,cAAc;YAChB;YACA,QAAQ,YAAY,OAAO,CAAC;QAC9B;QAEA,OAAO;YACL,QAAQ;YACR,SAAS,SAAS,EAAE;YACpB,QAAQ,SAAS,MAAM;YACvB,SAAS,SAAS,EAAE,GAAG,qBAAqB,CAAC,KAAK,EAAE,SAAS,MAAM,EAAE;QACvE;IACF,EAAE,OAAO,OAAO;QACd,OAAO;YACL,QAAQ;YACR,SAAS;YACT,QAAQ;YACR,SAAS,CAAC,gBAAgB,EAAE,iBAAiB,QAAQ,MAAM,OAAO,GAAG,iBAAiB;QACxF;IACF;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,MAAM,aAAa;IAEnB,IAAI;QACF,MAAM,UAAU,MAAM,QAAQ,UAAU,CACtC,eAAe,GAAG,CAAC,CAAA,SACjB,mBAAmB,OAAO,GAAG,EAAE,YAAY,OAAO,IAAI;QAI1D,MAAM,gBAAgB,QAAQ,GAAG,CAAC,CAAA,SAChC,OAAO,MAAM,KAAK,cAAc,OAAO,KAAK,GAAG;gBAC7C,QAAQ;gBACR,SAAS;gBACT,SAAS;YACX;QAGF,MAAM,eAAe,cAAc,MAAM,CAAC,CAAA,IAAK,EAAE,OAAO,EAAE,MAAM;QAChE,MAAM,aAAa,cAAc,MAAM;QAEvC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS,CAAC,SAAS,EAAE,aAAa,QAAQ,EAAE,WAAW,SAAS,CAAC;YACjE,WAAW,IAAI,OAAO,WAAW;YACjC,aAAa;YACb;YACA,SAAS;gBACP,OAAO;gBACP,YAAY;gBACZ,QAAQ,aAAa;YACvB;QACF;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAE5C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS;YACT,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;YAChD,WAAW,IAAI,OAAO,WAAW;QACnC,GAAG;YAAE,QAAQ;QAAI;IACnB;AACF;AAEO,eAAe;IACpB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;QACvB,SAAS;QACT,WAAW;YACT,SAAS;YACT,SAAS;QACX;QACA,mBAAmB,eAAe,GAAG,CAAC,CAAA,SAAU,OAAO,IAAI;IAC7D;AACF","debugId":null}}]
}